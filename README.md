# Bilibili 收藏夹自动整理脚本

这个仓库提供一个可直接在浏览器运行（Tampermonkey 或控制台）的脚本：

- 输入多个收藏夹名称；
- 统计这些收藏夹内每位 UP 主的视频数量；
- 按 UP 主出现数量自动分组并创建新收藏夹；
- 自动把视频移动到新收藏夹；
- 在现有 UI 内显示执行前确认弹窗、执行中实时进度、执行后结果弹窗。

> 仅处理你自己的视频收藏夹，依赖当前浏览器登录态（Cookie），不需要额外 API 凭证。

## 文件

- `bilibili_fav_auto_sort.user.js`：主脚本。

## 使用方式

1. 登录 B 站并打开「我的收藏夹」页面，URL 类似：
   `https://space.bilibili.com/<你的mid>/favlist`
2. 用 Tampermonkey 新建脚本并粘贴 `bilibili_fav_auto_sort.user.js` 内容（或直接在控制台执行 IIFE 主体代码）。
3. 运行脚本后，页面右下角会出现「收藏夹智能整理」按钮，点击后弹出可视化面板。
4. 在面板中填写：
   - 要处理的收藏夹名称（支持英文逗号、中文逗号、分号或换行分隔）；
   - 新收藏夹基础名称（默认自动名，长度≤10字符）；
   - 每个新收藏夹的视频上限（1-1000，可自定义，例如 800）。
5. 点击“开始执行”后流程如下：
   - **执行前确认**：在 UI 弹窗中显示“即将移动的视频数量、目标收藏夹数量、UP 主数量、分组计划”。
   - **执行中进度**：面板底部状态会实时刷新百分比和已处理数量（例如“移动视频 35%（15/43）”）。
   - **执行完成**：在 UI 弹窗中显示完成结果（成功数、失败数和新收藏夹信息）。

## 分组规则

- B 站单收藏夹上限为 1000 视频；脚本支持你手动设置更小“目标上限”（例如 800）。
- 拆分时遵循「不拆分同一个 UP 主」原则：
  - 若当前目标收藏夹已接近上限，而下一个 UP 视频数量过多，则该 UP 会整体进入下一个目标收藏夹。
- 为了让“视频更多的 UP 主”排在新收藏夹前几页，脚本会在移动时使用反向写入顺序（适配 B 站按最新收藏时间展示机制）。

## 注意事项

- 建议先用少量收藏夹做一次验证。
- 脚本行为是**移动**而不是复制。
- 收藏夹名需精确匹配（忽略大小写、前后空格）。
- 若某个 UP 单独视频数量 > 1000，因平台上限无法做到完全不拆分，脚本会报错中止。
- 若接口变更导致失败，请根据浏览器网络面板抓包校验参数。
